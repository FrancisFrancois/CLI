#!/usr/bin/env node

const axios = require("axios");
const prompt = require("prompts");
const chalk = require("chalk");
const country = require("country-list");

const URL = "https://date.nager.at/api/v3/PublicHolidays/";

//Terminal maker
const err = chalk.bold.red;
const yellow = chalk.yellow;
const magenta = chalk.magenta;
const indigo = chalk.bgRgb(75, 0, 130);

const message = indigo("Enter you Country :");
const messageTwo = indigo("Enter the desired year:");
const ask = [
  { type: "text", name: "countryName", message: message },
  { type: "number", name: "whichYear", message: messageTwo },
];
const day = async () => {
  const response = await prompt(ask);
  const getCountry = response.countryName;
  const getYear = response.whichYear;
  const countryCode = country.getCode(getCountry);

  const log = yellow(`Holidays for ${getCountry} this year ${getYear}`);
  try {
    const responseAPI = await axios.get(`${URL}${getYear}/${countryCode}`);
    const days = Array.from(responseAPI.data);
    console.log(log);
    days.forEach((e) => {
      console.log(magenta(` Date : ${e.date}  Party name : ${e.name}`));
    });
  } catch (error) {
    console.error(err("Value is invalid"), error.message);
  }
};

day();
